{% load static %}
{% include 'user/trial.html' %}

{% block content %}

<div class="container mt-5">
    <h2 class="mb-4">Add New Address</h2>

    <form method="POST" action="{% url 'add_address' %}">
        {% csrf_token %}

        <div class="form-group">
            <label for="house_name">House Name</label>
            <input type="text" class="form-control" id="house_name" name="house_name" required
                   title="Only letters, numbers, and spaces allowed."
                   oninput="validateHouseName(this)">
        </div>

        <div class="form-group">
            <label for="postal_address">Postal Address</label>
            <input type="text" class="form-control" id="postal_address" name="postal_address" required
                   title="Only letters, numbers, commas, and spaces allowed."
                   oninput="validatePostalAddress(this)">
        </div>

        <div class="form-group">
            <label for="city">City</label>
            <input type="text" class="form-control" id="city" name="city" required
                   title="Only letters and spaces allowed."
                   oninput="validateCity(this)">
        </div>

        <div class="form-group">
            <label for="district">District</label>
            <input type="text" class="form-control" id="district" name="district" required
                   title="Only letters and spaces allowed."
                   oninput="validateDistrict(this)">
        </div>

        <div class="form-group">
            <label for="state">State</label>
            <input type="text" class="form-control" id="state" name="state" required
                   title="Only letters and spaces allowed."
                   oninput="validateState(this)">
        </div>

        <div class="form-group">
            <label for="pincode">Pincode</label>
            <input type="text" class="form-control" id="pincode" name="pincode" required
                   title="Enter a valid 6-digit pincode."
                   oninput="validatePincode(this)">
        </div>

        <div class="form-group text-center mt-4">
            <button type="submit" class="btn btn-primary">Save Address</button>
            <a href="{% url 'checkout' %}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>

<script>
    function validateHouseName(input) {
        const pattern = /^[A-Za-z0-9\s]+$/;
        if (!pattern.test(input.value)) {
            input.value = input.value.replace(/[^a-zA-Z0-9\s]/g, '');
        }
    }

    function validatePostalAddress(input) {
        const pattern = /^[A-Za-z0-9\s,]+$/;
        if (!pattern.test(input.value)) {
            input.value = input.value.replace(/[^a-zA-Z0-9\s,]/g, '');
        }
    }

    function validateCity(input) {
        const pattern = /^[A-Za-z\s]+$/;
        if (!pattern.test(input.value)) {
            input.value = input.value.replace(/[^a-zA-Z\s]/g, '');
        }
    }

    function validateDistrict(input) {
        const pattern = /^[A-Za-z\s]+$/;
        if (!pattern.test(input.value)) {
            input.value = input.value.replace(/[^a-zA-Z\s]/g, '');
        }
    }

    function validateState(input) {
        const pattern = /^[A-Za-z\s]+$/;
        if (!pattern.test(input.value)) {
            input.value = input.value.replace(/[^a-zA-Z\s]/g, '');
        }
    }

    function validatePincode(input) {
    // Remove any non-digit characters and limit input to 6 digits
    input.value = input.value.replace(/[^0-9]/g, '').slice(0, 6);
}
    
</script>

{% endblock content %}
